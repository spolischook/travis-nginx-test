{% extends 'OroDashboardBundle:Dashboard:chartWidget.html.twig' %}

{% block content %}

{% if hasData %}
    <div class="chart-container">
        <div class="clearfix">
            <div id="{{ widgetId }}-chart" class="bar-chart chart"></div>
        </div>
    </div>

    {% set json = {
        'chart': {
            'manageResize' : '1',
            'numberPrefix' : '$',
            'animation': '1',
            'formatNumberScale': '0',
            'decimals': '2',
            'isHollow': '0',
            'labeldistance': '50',
            'useSameSlantAngle': '1',
            'bgalpha': '0',
            'showborder': '0',
            'streamlineddata': '0',
            'issliced': '0',
            'funnelYScale': '30',
        },
        'data': items
    } %}

    <script type="text/javascript">
        require(
            ['jquery', 'orocrmprofusioncharts/lib/FusionCharts.jqueryplugin'],
            function ($) {
                $('#{{ widgetId }}-chart').insertFusionCharts({
                    type: 'Funnel',
                    renderer: 'JavaScript',
                    dataSource: '{{ json|json_encode|raw }}',
                    dataFormat: 'json',
                    width: '100%',
                    height: '400',
                    id: '{{ widgetId }}'
                });
            }
        );
    </script>
{% else %}
    <div class="clearfix no-data">
        <span>{{ 'oro.dashboard.no_data_found'|trans }}</span>
    </div>
{% endif %}

{% endblock %}
