parameters:
    oro_ews.connector.class:                         OroPro\Bundle\EwsBundle\Connector\EwsConnector
    oro_ews.services.class:                          OroPro\Bundle\EwsBundle\Ews\ExchangeWebServices
    oro_ews.search_query.builder.class:              OroPro\Bundle\EwsBundle\Connector\Search\SearchQueryBuilder
    oro_ews.search_query.state.class:                OroPro\Bundle\EwsBundle\Connector\Search\SearchQuery
    oro_ews.search_query.query_string.builder.class: OroPro\Bundle\EwsBundle\Connector\Search\QueryStringBuilder
    oro_ews.search_query.restriction.builder.class:  OroPro\Bundle\EwsBundle\Connector\Search\RestrictionBuilder
    oro_ews.email_synchronizer.class:                OroPro\Bundle\EwsBundle\Sync\EwsEmailSynchronizer

services:
    oro_ews.connector:
        class: %oro_ews.connector.class%
        arguments:
            - @oro_ews.services

    oro_ews.services:
        public: false
        class: %oro_ews.services.class%
        arguments: # TODO: use ConfigurationBundle to get server, username and password
            - %oro_ews.wsdl_endpoint% # wsdlFile
            - "orolab.net:8091"         # server
            - Administrator           # username
            - Win2008ServDc2           # password
            - Exchange2010            # Exchange version
            - false                   # ignoreFailedResponseMessages

    oro_ews.search_query.builder:
        scope: prototype
        class: %oro_ews.search_query.builder.class%
        arguments:
            - @oro_ews.search_query.state

    oro_ews.search_query.state:
        public: false
        scope: prototype
        class: %oro_ews.search_query.state.class%
        arguments:
            - @oro_ews.search_query.query_string.builder
            - @oro_ews.search_query.restriction.builder

    oro_ews.search_query.query_string.builder:
        public: false
        class: %oro_ews.search_query.query_string.builder.class%

    oro_ews.search_query.restriction.builder:
        public: false
        class: %oro_ews.search_query.restriction.builder.class%

    oro_ews.email_synchronizer:
        scope: prototype
        class: %oro_ews.email_synchronizer.class%
        arguments:
            - @doctrine.orm.entity_manager
            - @oro_email.email.entity.builder
            - @oro_email.email.address.manager
            - @oro_email.email.owner.provider.storage
            - @oro_ews.connector
            - %oro_user.entity.class%
        tags:
            - { name: oro_email.email_synchronizer }
