parameters:
    oropro_organization.entity.class: Oro\Bundle\OrganizationBundle\Entity\Organization

    oropro_organization.twig.extension.organization.class: OroPro\Bundle\OrganizationBundle\Twig\OrganizationExtension
    oropro_organization.twig.extension.search_organization.class: OroPro\Bundle\OrganizationBundle\Twig\SearchResultOrganizationExtension
    oropro_organization.exclusion_provider.config.class:   OroPro\Bundle\OrganizationBundle\Provider\OrganizationExclusionProvider
    oropro_organization.system_mode_org_provider.class:    OroPro\Bundle\OrganizationBundle\Provider\SystemAccessModeOrganizationProvider
    oropro_organization.request.param_converter.class:     OroPro\Bundle\OrganizationBundle\Request\ParamConverter\RequestReportParamConverter
    oropro_organization.helper.class:                      OroPro\Bundle\OrganizationBundle\Helper\OrganizationProHelper
    oropro_organization.listener.organization_select_listener.class: OroPro\Bundle\OrganizationBundle\EventListener\OrganizationSelectListener
    oropro_organization.listener.system_org_grid_listener.class: OroPro\Bundle\OrganizationBundle\EventListener\SystemModeOrganizationGridListener
    oropro_organization.event_listener.workflow_listener.class: OroPro\Bundle\OrganizationBundle\EventListener\WorkflowListener

    oropro_organization.exception.organization_aware_listener.class: OroPro\Bundle\OrganizationBundle\Exception\OrganizationAwareExceptionListener
    oropro_organization.grid.extension.organization_column.class: OroPro\Bundle\OrganizationBundle\Grid\OrganizationColumnExtension

    # Overrides
    oro_entity.listener.navigation_listener.class: OroPro\Bundle\OrganizationBundle\EventListener\EntityNavigationListener
    oro_report.listener.navigation_listener.class: OroPro\Bundle\OrganizationBundle\EventListener\ReportNavigationListener
    oro_organization.twig.organization.class:      OroPro\Bundle\OrganizationBundle\Twig\OrganizationProExtension
    oro_organization.form.extension.organization.class: OroPro\Bundle\OrganizationBundle\Form\Extension\OrganizationProFormExtension

services:
    oropro_organization.twig.extension.organization:
        class: %oropro_organization.twig.extension.organization.class%
        arguments:
            - @oro_entity_config.provider.organization
            - @doctrine
            - @translator
            - @oropro_organization.helper
        tags:
            - { name: twig.extension }

    oropro_organization.twig.extension.search_organization:
        class: %oropro_organization.twig.extension.search_organization.class%
        arguments:
            - @oro_security.security_facade
            - @oro_entity_config.provider.ownership
            - @oro_entity.doctrine_helper
        tags:
            - { name: twig.extension }

    oropro_organization.exclusion_provider:
        class: %oropro_organization.exclusion_provider.config.class%
        arguments:
            - @oro_security.security_facade.link
            - @oro_entity_config.provider.organization
            - @oropro_organization.system_mode_org_provider
        tags:
            - { name: oro_entity.exclusion_provider.default }

    oropro_organization.system_mode_org_provider:
        class: %oropro_organization.system_mode_org_provider.class%

    oropro_organization.request.param_converter:
        class: %oropro_organization.request.param_converter.class%
        arguments:
            - @oro_entity_config.provider.organization
            - @oro_security.security_facade
            - @doctrine
        tags:
            - { name: request.param_converter, priority: 2, converter: applicable_organization_converter }

    oropro_organization.grid.extension.organization_column:
        class: %oropro_organization.grid.extension.organization_column.class%
        arguments:
            - @oro_security.security_facade
            - @oro_entity_config.config_manager
            - @oro_entity.orm.entity_class_resolver
            - @oropro_organization.system_mode_org_provider
        tags:
            - { name: oro_datagrid.extension }
            
    oropro_organization.helper:
        class: %oropro_organization.helper.class%
        arguments:
            - @doctrine

    oropro_organization.listener.organization_select_listener:
        class: %oropro_organization.listener.organization_select_listener.class%
        arguments:
            - @oropro_organization.system_mode_org_provider
            - @doctrine
            - @oro_security.security_facade
            - @router
            - @oro_workflow.manager
            - @oro_security.owner.ownership_metadata_provider
        tags:
            - { name: kernel.event_listener, event: kernel.request, method: onKernelRequest}

    oropro_organization.event_listener.system_org_grid_listener:
        class: %oropro_organization.listener.system_org_grid_listener.class%
        arguments:
            - @oropro_organization.system_mode_org_provider
            - @doctrine
            - @oro_security.security_facade
        tags:
            - { name: kernel.event_listener, event: oro_datagrid.datagrid.build.before, method: onBuildBefore, priority: 1 }

    oropro_organization.event_listener.workflow_listener:
        class: %oropro_organization.event_listener.workflow_listener.class%
        arguments:
            - @oropro_organization.system_mode_org_provider
            - @oro_security.security_facade
            - @oro_entity.doctrine_helper
            - @oro_security.owner.ownership_metadata_provider
        tags:
            - { name: kernel.event_listener, event: oro_workflow.action.handle_before, method: onBeforeAction }
            - { name: kernel.event_listener, event: oro_workflow.start_transition.handle_before_render, method: onStartTransition }

    oropro_organization.exception.organization_aware_listener:
        class: %oropro_organization.exception.organization_aware_listener.class%
        arguments:
           - @router
           - @oropro_organization.system_mode_org_provider
        tags:
            - { name: kernel.event_listener, event: kernel.exception, method: onKernelException }
