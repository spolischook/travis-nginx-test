services:
    oro_messaging.zeroconfig.config:
        class: 'Oro\Component\Messaging\ZeroConfig\Config'
        arguments:
            - '%oro_messaging.zeroconfig.prefix%'
            - '%oro_messaging.zeroconfig.router_topic%'
            - '%oro_messaging.zeroconfig.router_queue%'
            - '%oro_messaging.zeroconfig.queue_topic%'
            - '%oro_messaging.zeroconfig.default_queue_queue%'

    oro_messaging.zeroconfig.transport.session:
        class: 'Oro\Component\Messaging\Transport\Amqp\AmqpSession'
        factory: ['@oro_messaging.transport.amqp.connection', 'createSession']

    oro_messaging.zeroconfig.session:
        class: 'Oro\Component\Messaging\ZeroConfig\Amqp\AmqpSession'
        arguments:
            - '@oro_messaging.zeroconfig.transport.session'
            - '@oro_messaging.zeroconfig.config'

    oro_messaging.zeroconfig.route_registry:
        class: 'Oro\Component\Messaging\ZeroConfig\GenericRouteRegistry'

    oro_messaging.zeroconfig.route_message_processor:
        class: 'Oro\Component\Messaging\ZeroConfig\RouterMessageProcessor'
        arguments:
            - '@oro_messaging.zeroconfig.session'
            - '@oro_messaging.zeroconfig.route_registry'

    oro_messaging.zeroconfig.route_command:
        class: Oro\Component\Messaging\ZeroConfig\RouteMessagesCommand
        arguments:
            - '@oro_messaging.consumption.queue_consumer'
            - '@oro_messaging.zeroconfig.route_message_processor'
            - '@oro_messaging.zeroconfig.config'
        tags:
            - { name: 'console.command' }


    my_message_processor:
        class: Oro\Bundle\MessagingBundle\MyTestMessageProcessor
        tags:
            - { name: 'oro_messaging.zeroconfig.message_processor', messageName: 'message-name' }
            - { name: 'oro_messaging.zeroconfig.message_processor', messageName: 'message-name2' }
