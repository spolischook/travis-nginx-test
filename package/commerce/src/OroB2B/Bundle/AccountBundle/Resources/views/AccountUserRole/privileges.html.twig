{% set prefix = prefix|default('orob2b.account.security.access-level.') %}
{% set none_ownership = constant('Oro\\Bundle\\OrganizationBundle\\Form\\Type\\OwnershipType::OWNER_TYPE_NONE') %}

{% if privilegeConfig.view_type == 'grid' %}
    <table class="table table-striped acl-table">
        <tbody>
        <tr>
            <th>
                &nbsp;
            </th>
            {% set width = ((100/(privilegeConfig['permissions']|length + 1))-1)|number_format(0) %}
            {% for field in privilegeConfig['permissions'] %}
                <th width="{{ width }}%">
                    {{ field|trans }}
                </th>
            {% endfor %}
        </tr>
        {% for privilege in privileges.data[privilegeConfigName] %}
            <tr>
                <td>
                    <strong>{{ privilege.identity.name|trans }}</strong>
                </td>
                {% for field in privilegeConfig['permissions'] %}
                    <td>
                        {% for permission in privilege.permissions %}
                            {% if permission.name == field %}
                                {% set accessLevel = prefix ~ (privileges.accessLevelNames[permission.accessLevel-1])|default(none_ownership) %}
                                <div>{{ accessLevel|trans }}</div>
                            {% endif %}
                        {% endfor %}
                        &nbsp;
                    </td>
                {% endfor %}
            </tr>
        {% endfor %}
        </tbody>
    </table>
{% else %}
    {% for privilege in privileges.data[privilegeConfigName] %}
        <div class="security-row row-fluid">
            <div class="span8">
                <strong>{{ privilege.identity.name|trans }}</strong>
            </div>
            {% for permission in privilege.permissions %}
                {% set accessLevel = prefix ~ (privileges.accessLevelNames[permission.accessLevel-1])|default(none_ownership) %}
                <div class="span2">{{ accessLevel|trans }}</div>
            {% endfor %}
        </div>
    {% endfor %}
{% endif %}
