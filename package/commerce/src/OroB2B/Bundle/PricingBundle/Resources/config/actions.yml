actions:
    orob2b_pricing_add_product_price_action:
        label: orob2b.pricing.add_product_price
        applications: [backend]
        routes: [orob2b_pricing_price_list_view]
        order: 10
        acl_resource: ['CREATE', 'entity:OroB2B\Bundle\PricingBundle\Entity\ProductPrice']

        button_options:
            icon: icon-plus

        frontend_options:
            template: OroB2BPricingBundle:Action:addProductPrice.html.twig
            options:
                allowMaximize: true
                allowMinimize: true
                dblclick: maximize
                maximizedHeightDecreaseBy: minimize-bar
                width: 650

        attributes:
            price:
                label: ' '
                type: object
                options:
                    class: OroB2B\Bundle\PricingBundle\Entity\ProductPrice

        form_options:
            attribute_fields:
                price:
                    form_type: orob2b_pricing_price_list_product_price
                    options:
                        required: true
            attribute_default_values:
                price: $.price

        form_init:
            - @create_object:
                class: OroB2B\Bundle\PricingBundle\Entity\ProductPrice
                attribute: $.price
            - @assign_value: [$.price.priceList, $.data]

        functions:
            - @create_entity:
                class: OroB2B\Bundle\PricingBundle\Entity\ProductPrice
                attribute: $.newPrice
                data:
                    product: $.price.product
                    priceList: $.data
                    quantity: $.price.quantity
                    unit: $.price.unit
                    price: $.price.price
                flush: true
            - @refresh_grid: price-list-product-prices-grid
            - @flash_message:
                message: orob2b.pricing.productprice.save.success
                type: 'success'
