parameters:
    #integration
    orocrmpro_ldap.provider.channel_type.class:               OroCRMPro\Bundle\LDAPBundle\Provider\ChannelType
    orocrmpro_ldap.provider.connector.user.class:             OroCRMPro\Bundle\LDAPBundle\Provider\Connector\UserLdapConnector
    orocrmpro_ldap.provider.transport.ldap.class:             OroCRMPro\Bundle\LDAPBundle\Provider\Transport\LdapTransport
    #event listeners
    orocrmpro_ldap.event_listener.user_change_listener.class: OroCRMPro\Bundle\LDAPBundle\EventListener\UserChangeListener
    orocrmpro_ldap.event_listener.user_before_value_render_listener.class: OroCRMPro\Bundle\LDAPBundle\EventListener\UserBeforeRenderListener
    orocrmpro_ldap.event_listener.load_integration_themes_listener.class: OroCRMPro\Bundle\LDAPBundle\EventListener\LoadIntegrationThemesListener
    orocrmpro_ldap.event_listener.import_validation_subscriber.class: OroCRMPro\Bundle\LDAPBundle\EventListener\ImportValidationSubscriber
    #security
    orocrmpro_ldap.authentication.provider.class:             OroCRMPro\Bundle\LDAPBundle\Security\LdapAuthenticationProvider
    orocrmpro_ldap.security.authenticator.class:              OroCRMPro\Bundle\LDAPBundle\Security\LdapAuthenticator

services:
    orocrmpro_ldap.provider.channel_type:
        class: %orocrmpro_ldap.provider.channel_type.class%
        tags:
            - { name: oro_integration.channel, type: ldap }

    orocrmpro_ldap.provider.transport.ldap:
        class: %orocrmpro_ldap.provider.transport.ldap.class%
        tags:
            - { name: oro_integration.transport, type: ldap, channel_type: ldap }

    orocrmpro_ldap.provider.connector.user:
        class: %orocrmpro_ldap.provider.connector.user.class%
        arguments:
            - "@oro_importexport.context_registry"
            - "@oro_integration.logger.strategy"
            - "@oro_integration.provider.connector_context_mediator"
        tags:
            - { name: oro_integration.connector, type: user, channel_type: ldap }

    orocrmpro_ldap.event_listener.user_before_value_render_listener:
        class: %orocrmpro_ldap.event_listener.user_before_value_render_listener.class%
        arguments: ["@doctrine"]
        tags:
            - { name: kernel.event_listener, event: oro.entity_extend_event.before_value_render, method: beforeValueRender }

    orocrmpro_ldap.event_listener.load_integration_themes_listener:
        class: %orocrmpro_ldap.event_listener.load_integration_themes_listener.class%
        tags:
            - { name: kernel.event_listener, event: oro_integration.load_integration_themes, method: onLoad }

    orocrmpro_ldap.security.authenticator:
        class: %orocrmpro_ldap.security.authenticator.class%
        arguments: ["@doctrine", "@orocrmpro_ldap.provider.transport.ldap"]

    orocrmpro_ldap.authentication.provider:
        class: %orocrmpro_ldap.authentication.provider.class%
        parent: oro_security.authentication.provider.username_password_organization
        arguments:
            - "@orocrmpro_ldap.security.authenticator"
        abstract: true

    orocrmpro_ldap.sync_scheduler.link:
        tags:
            - { name: oro_service_link,  service: oro_integration.sync_scheduler }

    orocrmpro_ldap.doctrine.link:
        tags:
            - { name: oro_service_link,  service: doctrine }

    orocrmpro_ldap.event_listener.user_change_listener:
        class:  %orocrmpro_ldap.event_listener.user_change_listener.class%
        tags:
            - { name: doctrine.event_listener, event: onFlush }
            - { name: doctrine.event_listener, event: postFlush }
        arguments: ["@orocrmpro_ldap.doctrine.link", "@oro_integration.sync_scheduler.link"]

    orocrmpro_ldap.event_listener.import_validation_subscriber:
        class: %orocrmpro_ldap.event_listener.import_validation_subscriber.class%
        arguments:
            - "@oro_entity.doctrine_helper"
            - "@oro_importexport.strategy.import.helper"
        tags:
            - { name: kernel.event_listener, event: oro_importexport.strategy.process_before, method: beforeProcess }
